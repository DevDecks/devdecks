import * as React from 'react';

// For select image file dialog prompt
import selectImageFile from './AddImageDialog';

interface AddImageProps {
  pluginState: any;
  updateCurrentPlugin: Function;
}

const AddImage = ({ pluginState, updateCurrentPlugin }: AddImageProps) => {

  /**
   * Determine what image component to render
   *
   * Given image URL: Render the online image
   * Given image buffer string: Render the image added from the file system
   * Default behavior: Render the placeholder image
   */
  const { width, imageBufferString, imageUrl } = pluginState;
  let componentToRender: any;
  if (imageUrl && /https?:\/\/.+\.(gif|jpg|jpeg|png|svg)$/.test(imageUrl)) {
    componentToRender = (
      <img
        max="100%"
        width={ width }
        draggable={ false }
        src={ imageUrl } />
    );
  } else if (imageBufferString) {
    componentToRender = (
      <img
        max="100%"
        width={ width }
        draggable={ false }
        src={ `data:image;base64,${imageBufferString}` } />
    );
  } else {
    componentToRender = (
      <span
        className="pt-icon pt-icon-media"
        style={{ fontSize: 300, opacity: 0.4, margin: '-25px 0' }}
        onDoubleClick={ () => selectImageFile(updateCurrentPlugin) } />
    );
  }

  return (
    <div>{ componentToRender }</div>
  );
}

export default AddImage;
